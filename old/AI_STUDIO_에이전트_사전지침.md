# Google AI Studio 에이전트 사전 지침 (System Prompt)

**프로젝트명**: ForwardMax 딜러 웹앱  
**SSOT 문서**: `FOWARDMAX/PRD_Phase1_2025-12-31.md` (v2.13)  
**작성일**: 2025-12-31  
**목적**: 기존 코드 보존 및 PRD 기반 점진적 개발 보장

---

## 🚨 CRITICAL RULES (절대 준수 사항)

### 1. 기존 파일 보존 원칙 (최우선)

**절대 금지 사항**:
- ❌ **기존 파일을 전체 재작성하지 마세요**
- ❌ **index.html, index.tsx, package.json 등 핵심 파일을 처음부터 다시 작성하지 마세요**
- ❌ **사용자가 명시적으로 요청하지 않는 한, 기존 코드 구조를 완전히 변경하지 마세요**

**필수 준수 사항**:
- ✅ **기존 파일을 먼저 읽고 분석한 후, 필요한 부분만 수정하세요**
- ✅ **기존 코드 스타일, 네이밍 컨벤션, 아키텍처를 최대한 유지하세요**
- ✅ **작은 단위로 점진적 수정하세요 (전체 재작성 금지)**

### 2. PRD 문서 우선 참조 원칙

**SSOT 문서 위치**: `C:\carivdealer\FOWARDMAX\PRD_Phase1_2025-12-31.md`

**필수 작업 순서**:
1. **모든 작업 시작 전 PRD 문서를 먼저 참조하세요**
2. **기능 구현 시 PRD의 Function Registry (Section 6.2) 확인**
3. **화면 구현 시 PRD의 Screen Registry (Section 6.1) 확인**
4. **플로우 구현 시 PRD의 User Flows (Section 9) 확인**
5. **API 구현 시 PRD의 API Registry (Section 14) 확인**

**PRD 문서 구조**:
- Section 6: ID 레지스트리 (Screen, Function, Flow, Entity, API, Event, Decision, NFR)
- Section 7: 기능-화면-메타데이터 매핑 테이블
- Section 8: 정보구조(IA) 및 사이트맵
- Section 9: 사이트맵 기반 유저플로우
- Section 10: FRD (세부 기능 명세)
- Section 12: NFR (비기능 요구사항)
- Section 13: TSD (기술 설계)
- Section 14: SRD (서비스 요구)
- Section 15: 상태 전이 매핑
- Section 23.5~23.6: output.json 참조 (IA/SPM)

---

## 📋 작업 수행 원칙

### 3. 점진적 수정 원칙

**작업 단위**:
- ✅ **한 번에 하나의 기능/화면/컴포넌트만 수정하세요**
- ✅ **수정 범위를 명확히 제한하세요**
- ✅ **기존 코드의 동작하는 부분은 건드리지 마세요**

**수정 전 확인 사항**:
1. 기존 파일이 존재하는가?
2. 기존 파일의 구조와 스타일은 무엇인가?
3. 수정이 필요한 부분만 정확히 식별했는가?
4. 수정이 기존 기능에 영향을 주지 않는가?

### 4. 명확한 작업 범위 제한

**작업 시작 전 필수 확인**:
```
1. 사용자가 요청한 작업 범위는 무엇인가?
2. 기존 파일에서 수정이 필요한 부분은 어디인가?
3. PRD 문서에서 해당 기능/화면의 명세는 무엇인가?
4. 수정 후 기존 기능이 정상 동작하는가?
```

**작업 범위 명시 예시**:
- ❌ "전체 앱을 다시 작성합니다"
- ✅ "index.tsx의 로그인 컴포넌트만 수정합니다 (PRD FUNC-00 참조)"

---

## 🔍 파일 수정 프로세스

### 5. 파일 수정 시 필수 절차

**Step 1: 기존 파일 읽기**
```typescript
// 먼저 기존 파일을 읽고 분석
read_file('index.tsx')
read_file('index.html')
read_file('package.json')
```

**Step 2: PRD 문서 참조**
```typescript
// PRD 문서에서 관련 명세 확인
read_file('FOWARDMAX/PRD_Phase1_2025-12-31.md', section='관련 섹션')
```

**Step 3: 필요한 부분만 수정**
```typescript
// 전체 재작성 금지, 필요한 부분만 수정
search_replace(file_path, old_string='수정할 부분', new_string='수정된 부분')
```

**Step 4: 검증**
```typescript
// 수정 후 기존 기능이 정상 동작하는지 확인
read_lints([file_path])
```

### 6. 코드 작성 규칙

**기존 코드 스타일 유지**:
- ✅ 기존 파일의 import 순서 유지
- ✅ 기존 파일의 컴포넌트 구조 유지
- ✅ 기존 파일의 네이밍 컨벤션 유지
- ✅ 기존 파일의 주석 스타일 유지

**새 코드 추가 시**:
- ✅ 기존 코드와 일관성 유지
- ✅ PRD 문서의 명세에 맞게 작성
- ✅ 기존 컴포넌트 재사용 우선

---

## 📚 PRD 문서 참조 가이드

### 7. 기능 구현 시 PRD 참조 체크리스트

**기능 구현 전 확인 사항**:
- [ ] PRD Section 6.2 Function Registry에서 Function ID 확인
- [ ] PRD Section 7.2 Screen → Function 매핑에서 관련 화면 확인
- [ ] PRD Section 9 User Flows에서 플로우 확인
- [ ] PRD Section 10 FRD에서 세부 기능 명세 확인
- [ ] PRD Section 12 NFR에서 비기능 요구사항 확인
- [ ] PRD Section 13 TSD에서 기술 설계 확인
- [ ] PRD Section 14 SRD에서 서비스 요구 확인

**화면 구현 전 확인 사항**:
- [ ] PRD Section 6.1 Screen Registry에서 Screen ID 확인
- [ ] PRD Section 7.2 FLOW → Screen 매핑에서 플로우 확인
- [ ] PRD Section 8.2 사이트맵에서 IA 구조 확인
- [ ] PRD Section 9 User Flows에서 화면 전환 확인

**API 구현 전 확인 사항**:
- [ ] PRD Section 14 API Registry에서 API ID 확인
- [ ] PRD Section 7.2 Function → Entity/API/NFR 매핑 확인
- [ ] PRD Section 14 SRD에서 외부 연동 확인

### 8. output.json 참조 시 주의사항

**output.json 위치**: `FOWARDMAX/output.json`

**참조 원칙**:
- ✅ output.json은 **참조 자료**입니다
- ✅ PRD가 **SSOT (Single Source of Truth)**입니다
- ✅ 두 문서 간 불일치 시 **PRD를 우선**합니다
- ✅ output.json의 세부 항목은 PRD Section 23.5~23.6 참조

**매핑 테이블**:
- `FOWARDMAX/IA_PRD_매핑_테이블.md`: IA 항목 ↔ PRD Function/Screen 매핑
- `FOWARDMAX/SPM_PRD_매핑_테이블.md`: SPM 정책 ↔ PRD Decision/NFR 매핑

---

## 🛠️ 디버깅 및 리팩토링 원칙

### 9. 디버깅 시 원칙

**디버깅 전 확인**:
1. 에러 메시지가 무엇인가?
2. 에러가 발생한 파일과 라인은 어디인가?
3. 기존 코드에서 해당 부분의 의도는 무엇인가?
4. 최소한의 수정으로 해결할 수 있는가?

**디버깅 시 금지 사항**:
- ❌ 에러가 발생한 파일 전체를 재작성하지 마세요
- ❌ 관련 없는 파일까지 수정하지 마세요
- ❌ 기존 동작하는 코드를 변경하지 마세요

**디버깅 시 권장 사항**:
- ✅ 에러가 발생한 부분만 정확히 수정하세요
- ✅ 기존 코드의 의도를 파악한 후 수정하세요
- ✅ 수정 후 기존 기능이 정상 동작하는지 확인하세요

### 10. 리팩토링 시 원칙

**리팩토링 전 확인**:
1. 사용자가 명시적으로 리팩토링을 요청했는가?
2. 리팩토링이 필요한 이유는 무엇인가?
3. 리팩토링이 기존 기능에 영향을 주지 않는가?
4. PRD 문서의 명세와 일치하는가?

**리팩토링 시 금지 사항**:
- ❌ 사용자가 요청하지 않은 리팩토링을 하지 마세요
- ❌ 전체 파일 구조를 변경하지 마세요
- ❌ 기존 API/인터페이스를 변경하지 마세요

**리팩토링 시 권장 사항**:
- ✅ 작은 단위로 점진적 리팩토링하세요
- ✅ 기존 기능을 유지하면서 개선하세요
- ✅ 리팩토링 후 테스트를 수행하세요

---

## 📝 코드 작성 시 명확한 지침

### 11. 새 파일 생성 시 원칙

**새 파일 생성 전 확인**:
1. 정말 새 파일이 필요한가? (기존 파일 수정으로 해결 불가능한가?)
2. PRD 문서에서 해당 기능/화면의 명세는 무엇인가?
3. 기존 파일 구조와 일관성이 있는가?

**새 파일 생성 시 필수 사항**:
- ✅ PRD 문서의 명세에 맞게 작성
- ✅ 기존 파일 구조와 일관성 유지
- ✅ 기존 컴포넌트/유틸리티 재사용

### 12. 컴포넌트 작성 시 원칙

**컴포넌트 작성 전 확인**:
- [ ] PRD Section 6.1 Screen Registry에서 Screen ID 확인
- [ ] PRD Section 7.2 Screen → Function 매핑에서 관련 기능 확인
- [ ] PRD Section 9 User Flows에서 화면 전환 확인
- [ ] 기존 컴포넌트 구조와 일관성 확인

**컴포넌트 작성 시 필수 사항**:
- ✅ PRD의 Screen ID를 컴포넌트명/파일명에 반영
- ✅ PRD의 Function ID를 주석으로 명시
- ✅ 기존 컴포넌트 스타일과 일관성 유지

---

## ⚠️ 자주 발생하는 실수 방지

### 13. 절대 하지 말아야 할 것들

1. **전체 파일 재작성**
   - ❌ "index.tsx를 처음부터 다시 작성합니다"
   - ✅ "index.tsx의 특정 함수만 수정합니다"

2. **불필요한 파일 생성**
   - ❌ "새로운 구조로 전체 재구성합니다"
   - ✅ "기존 구조를 유지하면서 필요한 부분만 추가합니다"

3. **PRD 무시**
   - ❌ "일반적인 React 패턴으로 구현합니다"
   - ✅ "PRD Section X의 명세에 따라 구현합니다"

4. **기존 코드 무시**
   - ❌ "더 나은 방법으로 다시 작성합니다"
   - ✅ "기존 코드를 분석한 후 필요한 부분만 개선합니다"

### 14. 작업 시작 전 체크리스트

**모든 작업 시작 전 필수 확인**:
- [ ] 사용자가 요청한 작업 범위를 정확히 이해했는가?
- [ ] 기존 파일을 읽고 분석했는가?
- [ ] PRD 문서에서 관련 명세를 확인했는가?
- [ ] 수정이 필요한 부분만 정확히 식별했는가?
- [ ] 기존 기능에 영향을 주지 않는가?
- [ ] 작은 단위로 점진적 수정할 수 있는가?

---

## 🎯 작업 예시

### 올바른 작업 예시

**사용자 요청**: "로그인 화면에 이메일 입력 필드를 추가하세요"

**올바른 절차**:
1. ✅ 기존 `index.tsx` 파일 읽기
2. ✅ PRD Section 6.1에서 SCR-0001 확인
3. ✅ PRD Section 6.2에서 FUNC-00 확인
4. ✅ PRD Section 10에서 FUNC-00 세부 명세 확인
5. ✅ 기존 로그인 컴포넌트 구조 분석
6. ✅ 이메일 입력 필드만 추가 (기존 코드 보존)
7. ✅ 수정 후 검증

### 잘못된 작업 예시

**사용자 요청**: "로그인 화면에 이메일 입력 필드를 추가하세요"

**잘못된 절차**:
1. ❌ 기존 파일을 읽지 않고 새로 작성
2. ❌ PRD 문서를 참조하지 않음
3. ❌ 전체 로그인 컴포넌트를 재작성
4. ❌ 기존 코드 스타일 무시

---

## 📌 요약: 핵심 원칙

1. **기존 파일 보존 최우선**: 전체 재작성 금지, 필요한 부분만 수정
2. **PRD 문서 우선 참조**: 모든 작업 전 PRD 문서 확인 필수
3. **점진적 수정**: 작은 단위로 단계적 수정
4. **명확한 범위 제한**: 수정 범위를 명확히 하고 기존 기능 보존
5. **일관성 유지**: 기존 코드 스타일, 구조, 네이밍 유지

---

**이 지침은 모든 작업에 우선 적용되며, 사용자가 명시적으로 다른 지시를 하지 않는 한 절대적으로 준수해야 합니다.**

