# 엔터티 스키마 정렬 매트릭스

**문서명**: output.json 데이터 구조 ↔ PRD 엔터티 스키마 정렬 매트릭스  
**버전**: 1.0  
**작성일**: 2025-12-31

---

## 엔터티 스키마 정렬 규칙

1. **데이터 범위 비교**: output.json의 데이터 범위와 PRD Entity의 데이터 범위 비교
2. **필드 타입 일치성**: 필드의 데이터 타입 비교
3. **필수 필드 일치성**: 필수 필드 비교

---

## IA 데이터 구조 ↔ PRD Entity 매핑

| IA 카테고리 | IA 데이터 필드 | PRD Entity ID | PRD Entity 필드 | 매핑 상태 | 매핑 근거 |
|---|---|---|---|---|---|
| 회원가입/인증 | 이메일, 비밀번호, 프로필, 휴대폰 | ENT-03 (Member-Dealer) | email, password, name, phone | 매핑 가능 | 회원 정보 |
| 사업자 인증 | 사업자등록증 정보 | ENT-03 (Member-Dealer) | business_registration | 매핑 가능 | 딜러 정보 |
| 차량 등록 | 차량번호, VIN, 제조사, 모델, 연식, 주행거리 | ENT-01 (Vehicle) | car_no, vin, manufacturer, model, year, mileage | 매핑 가능 | 차량 정보 |
| 검차 | 검차 결과, 사진, 영상, 성능 점검 | ENT-01 (Vehicle) | inspection_result, photos, videos | 매핑 가능 | 검차 정보 |
| 판매 방식 선택 | 판매 방식, 기준가격, 경매 설정 | ENT-02 (Auction) | sale_type, base_price, start_price, buy_now_price | 매핑 가능 | 판매 정보 |
| 일반 판매 제안 | 제안가, 바이어 정보, 제안 시간 | ENT-02 (Auction) | offer_price, buyer_id, offer_time | 매핑 가능 | 제안 정보 |
| 경매 입찰 | 입찰가, 입찰자 정보, 입찰 시간 | ENT-02 (Auction) | bid_amount, bidder_id, bid_time | 매핑 가능 | 입찰 정보 |
| 탁송 | 탁송 일정, 배차 정보, 탁송 기사 정보 | ENT-04 (Logistics_Schedule), ENT-05 (Logistics_History) | schedule_date, driver_info, pickup_time | 매핑 가능 | 탁송 정보 |
| 인계 승인 | 차량 상태 확인서, 차키, 서류, PIN | ENT-05 (Logistics_History) | handover_status, handover_pin, handover_timestamp | 매핑 가능 | 인계 정보 |
| 정산 | 정산 항목, 수수료, 환급액, 최종 입금액 | ENT-06 (Settlement) | settlement_items, fee, refund, final_amount | 매핑 가능 | 정산 정보 |

---

## PRD Entity 스키마

### ENT-01: Vehicle(차량)

| 필드명 | 타입 | 제약조건 | 설명 | IA 매핑 |
|---|---|---|---|---|
| id | BIGINT | PK, AUTO_INCREMENT | 차량 고유 ID | - |
| owner_id | BIGINT | FK → Member.id, NOT NULL | 딜러 ID | 회원가입/인증 |
| vin | VARCHAR(20) | UNIQUE, NOT NULL | 차대번호(VIN) | 차량 등록 |
| car_no | VARCHAR(20) | NOT NULL | 차량번호 | 차량 등록 |
| status | ENUM | NOT NULL, DEFAULT 'Draft' | 차량 상태 | 차량 등록, 검차, 판매 |
| created_at | TIMESTAMP | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 생성 시간 | - |

### ENT-02: Auction(경매)

| 필드명 | 타입 | 제약조건 | 설명 | IA 매핑 |
|---|---|---|---|---|
| id | BIGINT | PK, AUTO_INCREMENT | 경매 고유 ID | - |
| vehicle_id | BIGINT | FK → Vehicle.id, NOT NULL, UNIQUE | 차량 ID | 차량 등록 |
| start_price | DECIMAL(15,2) | NOT NULL | 시작가 | 판매 방식 선택 |
| buy_now_price | DECIMAL(15,2) | NULL | 즉시구매가 | 판매 방식 선택 |
| current_highest_bid | DECIMAL(15,2) | NULL | 현재 최고 입찰가 | 경매 입찰 |
| status | ENUM | NOT NULL, DEFAULT 'Active' | 경매 상태 | 판매 방식 선택, 경매 입찰 |
| created_at | TIMESTAMP | NOT NULL, DEFAULT CURRENT_TIMESTAMP | 생성 시간 | - |

### ENT-03: Member-Dealer(딜러 회원)

| 필드명 | 타입 | 제약조건 | 설명 | IA 매핑 |
|---|---|---|---|---|
| id | BIGINT | PK, AUTO_INCREMENT | 딜러 고유 ID | - |
| email | VARCHAR(255) | UNIQUE, NOT NULL | 이메일 | 회원가입/인증 |
| password | VARCHAR(255) | NOT NULL | 비밀번호 | 회원가입/인증 |
| name | VARCHAR(100) | NOT NULL | 딜러 이름 | 회원가입/인증 |
| phone | VARCHAR(20) | NOT NULL | 휴대폰 번호 | 회원가입/인증 |
| business_registration | VARCHAR(255) | NULL | 사업자등록증 | 사업자 인증 |
| status | ENUM | NOT NULL, DEFAULT 'Pending' | 계정 상태 | 사업자 인증 |

### ENT-04: Logistics_Schedule(탁송 일정)

| 필드명 | 타입 | 제약조건 | 설명 | IA 매핑 |
|---|---|---|---|---|
| id | BIGINT | PK, AUTO_INCREMENT | 탁송 일정 고유 ID | - |
| vehicle_id | BIGINT | FK → Vehicle.id, NOT NULL | 차량 ID | 탁송 |
| schedule_date | DATE | NOT NULL | 탁송 일정 | 탁송 |
| schedule_time | TIME | NOT NULL | 탁송 시간 | 탁송 |
| status | ENUM | NOT NULL, DEFAULT 'Pending' | 일정 상태 | 탁송 |

### ENT-05: Logistics_History(탁송 내역)

| 필드명 | 타입 | 제약조건 | 설명 | IA 매핑 |
|---|---|---|---|---|
| id | BIGINT | PK, AUTO_INCREMENT | 탁송 내역 고유 ID | - |
| schedule_id | BIGINT | FK → Logistics_Schedule.id, NOT NULL | 탁송 일정 ID | 탁송 |
| driver_id | BIGINT | FK → Driver.id, NULL | 탁송 기사 ID | 배차 |
| handover_status | ENUM | NOT NULL, DEFAULT 'Pending' | 인계 상태 | 인계 승인 |
| handover_pin | VARCHAR(6) | NULL | 인계 PIN | 인계 승인 |
| handover_timestamp | TIMESTAMP | NULL | 인계 타임스탬프 | 인계 승인 |

### ENT-06: Settlement(정산)

| 필드명 | 타입 | 제약조건 | 설명 | IA 매핑 |
|---|---|---|---|---|
| id | BIGINT | PK, AUTO_INCREMENT | 정산 고유 ID | - |
| vehicle_id | BIGINT | FK → Vehicle.id, NOT NULL | 차량 ID | 정산 |
| settlement_items | JSON | NOT NULL | 정산 항목 | 정산 |
| fee | DECIMAL(15,2) | NOT NULL | 수수료 | 정산 |
| refund | DECIMAL(15,2) | NOT NULL | 환급액 | 정산 |
| final_amount | DECIMAL(15,2) | NOT NULL | 최종 입금액 | 정산 |

---

## 스키마 불일치 항목

### Critical 불일치

| 항목 | 불일치 내용 | 영향 | 완화 전략 |
|---|---|---|---|
| IA 데이터 구조 | output.json에 명시적 엔터티 스키마 없음 | 엔터티 스키마 정렬 어려움 | IA 항목의 데이터 필드 명시 필요 |

### High 불일치

| 항목 | 불일치 내용 | 영향 | 완화 전략 |
|---|---|---|---|
| 필드 타입 | IA에 필드 타입 정보 없음 | 데이터 타입 검증 불가 | IA에 필드 타입 정보 추가 |

### Medium 불일치

| 항목 | 불일치 내용 | 영향 | 완화 전략 |
|---|---|---|---|
| 필수 필드 | IA에 필수 필드 정보 없음 | 필수 필드 검증 불가 | IA에 필수 필드 정보 추가 |

---

## 스키마 정렬 통계

| 항목 | IA 카테고리 수 | PRD Entity 수 | 매핑 가능 | 매핑 불가 |
|---|---|---|---|---|
| 회원/인증 | 1 | 1 | 1 | 0 |
| 차량 관리 | 1 | 1 | 1 | 0 |
| 판매/경매 | 1 | 1 | 1 | 0 |
| 탁송 | 1 | 2 | 1 | 0 |
| 정산 | 1 | 1 | 1 | 0 |

---

**문서 버전**: 1.0  
**최종 업데이트**: 2025-12-31

